<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="goods">
	
		<insert id="insert" parameterType="goods.GoodsVO"
		useGeneratedKeys="true" keyProperty="goods_no">
		<selectKey keyProperty="goods_no" resultType="int" order="BEFORE">
			select
			seq_goods_no.nextval from dual
		</selectKey>
		
		insert into goods(
		goods_no,
		store_no,
		goods_name,
		goods_price,
		goods_sale_percent,
		goods_info,
		goods_gender,
		goods_status,
		goods_date,
		goods_main_image, 
		goods_sub_image, 
		goods_middle_category, 
		goods_sub_category, 
		goods_style,
		goods_sale_price
		) values(
		#{goods_no},
		#{store_no},
		#{goods_name},
		#{goods_price},
		#{goods_sale_percent},
		#{goods_info},
		#{goods_gender},
		'판매중',
		TO_DATE(SYSDATE, 'YYYY-MM-DD HH24:MI:SS'),
		#{goods_main_image}, 
		#{goods_sub_image}, 
		#{goods_middle_category}, 
		#{goods_sub_category}, 
		#{goods_style},
		#{goods_sale_price}
		)

	</insert>
	
<!-- 방명록에 딸린 첨부파일 정보 저장 -->
<insert id="fileRegister">
<foreach collection="fileList" item="file" open="insert all" separator=" " 
													close="select * from dual">
	into file_board ( file_name, file_path, writing_type )
	values ( #{file.file_name}, #{file.file_path}, 'g')
</foreach>

</insert>

<insert id="optionInsert">
<!--  
insert into goods_option(goods_option_no, goods_no, store_no, goods_middle_category, goods_sub_category, 
goods_size, goods_cnt, goods_style, goods_color) 
values(seq_goods_option_no.nextval, #{goods_no}, #{store_no}, #{goods_middle_category}, #{goods_sub_category}
, #{goods_size}, #{goods_cnt}, #{goods_style}, #{goods_color})
-->

<foreach collection="optionList" item="option" open="insert all" separator=" " 
													close="select * from dual">
	into goods_option (  goods_no, store_no,
goods_size, goods_cnt, goods_color )
	values( #{goods_no}, #{store_no}
, #{option.goods_size}, #{option.goods_cnt}, #{option.goods_color})
</foreach>
    
</insert>

<select id="list" resultType="goods.GoodsVO">
select * 
from goods
where store_no = #{store_no}
</select>



</mapper>